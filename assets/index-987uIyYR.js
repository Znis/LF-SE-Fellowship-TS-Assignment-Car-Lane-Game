var N=Object.defineProperty;var b=(t,n,a)=>n in t?N(t,n,{enumerable:!0,configurable:!0,writable:!0,value:a}):t[n]=a;var l=(t,n,a)=>(b(t,typeof n!="symbol"?n+"":n,a),a);(function(){const n=document.createElement("link").relList;if(n&&n.supports&&n.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))d(o);new MutationObserver(o=>{for(const c of o)if(c.type==="childList")for(const A of c.addedNodes)A.tagName==="LINK"&&A.rel==="modulepreload"&&d(A)}).observe(document,{childList:!0,subtree:!0});function a(o){const c={};return o.integrity&&(c.integrity=o.integrity),o.referrerPolicy&&(c.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?c.credentials="include":o.crossOrigin==="anonymous"?c.credentials="omit":c.credentials="same-origin",c}function d(o){if(o.ep)return;o.ep=!0;const c=a(o);fetch(o.href,c)}})();var s=(t=>(t.welcomeScreen="welcomeScreen",t.initialisation="initialisation",t.running="running",t.paused="paused",t.resume="resume",t.gameOver="gameOver",t.restart="restart",t))(s||{});const e={prevValidRandomYposition:0,collisionOccurred:!1,reqAnimFrame:0,opponentCarArray:[],playerCar:{},score:0,highScore:0,gameOver:!1,gameState:"welcomeScreen",isTransitionActive:!1};function S(t,n){return t+Math.floor((n-t)*Math.random())}const f={CANVAS_HEIGHT:600,CANVAS_WIDTH:600},g={MIN:-200,MAX:-2e3},P=3,u=Math.floor(f.CANVAS_WIDTH/P),C=80,m=160,w=Math.floor((u-C)/2),O=4;class x{constructor(n,a,d,o){l(this,"startPoint");l(this,"h");l(this,"w");l(this,"imagePath");l(this,"image");this.startPoint=n,this.h=a,this.w=d,this.imagePath=o,this.image=new Image,this.image.src=this.imagePath}}class y{constructor(n,a){l(this,"x");l(this,"y");l(this,"distance",n=>Math.sqrt((n.x-this.x)**2+(n.y-this.y)**2));this.x=n,this.y=a}}class E{constructor(n,a){l(this,"startPoint");l(this,"endPoint");l(this,"length",()=>Math.sqrt((this.endPoint.x-this.startPoint.x)**2+(this.endPoint.y-this.startPoint.y)**2));this.startPoint=n,this.endPoint=a}}const i=document.querySelector("#gameCanvas"),r=i.getContext("2d");i.width=f.CANVAS_WIDTH;i.height=f.CANVAS_HEIGHT;const p=[];for(let t=0;t<P-1;t++){const n=new E(new y(u*(t+1),0),new y(u*(t+1),f.CANVAS_HEIGHT));p.push(n)}function q(){i.style.display="block",r.clearRect(0,0,f.CANVAS_WIDTH,f.CANVAS_HEIGHT),r.fillStyle="#464646",r.fillRect(0,0,f.CANVAS_WIDTH,f.CANVAS_HEIGHT),V();for(let t=0;t<p.length;t++)r.setLineDash([50,20]),r.lineDashOffset-=O+e.score/5,r.lineWidth=4,r.beginPath(),r.moveTo(p[t].startPoint.x,p[t].startPoint.y),r.lineTo(p[t].endPoint.x,p[t].endPoint.y),r.strokeStyle="#FFF",r.stroke();r.beginPath(),r.drawImage(e.playerCar.image,e.playerCar.startPoint.x,e.playerCar.startPoint.y,e.playerCar.w,e.playerCar.h);for(let t=0;t<e.opponentCarArray.length;t++)r.beginPath(),r.drawImage(e.opponentCarArray[t].image,e.opponentCarArray[t].startPoint.x,e.opponentCarArray[t].startPoint.y,e.opponentCarArray[t].w,e.opponentCarArray[t].h)}i.addEventListener("click",()=>{e.gameOver&&I(),e.gameState==s.paused&&v()});function V(){r.font="24px Outfit",r.fillStyle="#fff",r.fillText("Score: "+e.score,10,30)}function _(){r.fillStyle="rgba(0, 0, 0, 0.8)",r.fillRect(0,0,i.width,i.height),r.font="48px Outfit",r.fillStyle="#ff0000",r.fillText("Game Over",i.width/2-130,i.height/2-50),r.font="32px Outfit",r.fillText(`Score: ${e.score}`,i.width/2-100,i.height/2+10),r.font="26px Outfit",r.fillText(`High Score: ${e.highScore}`,i.width/2-100,i.height/2+70),r.font="24px Outfit",r.fillText("Click to Restart",i.width/2-100,i.height/2+140)}function F(){r.fillStyle="rgba(0, 0, 0, 0.7)",r.fillRect(0,0,i.width,i.height),r.font="48px Outfit",r.fillStyle="orange",r.fillText("Game Paused",i.width/2-130,i.height/2-50),r.font="32px Outfit",r.fillText(`Score: ${e.score}`,i.width/2-100,i.height/2+10),r.font="26px Outfit",r.fillText(`High Score: ${e.highScore}`,i.width/2-100,i.height/2+70),r.font="24px Outfit",r.fillText("Click to Resume",i.width/2-100,i.height/2+140)}function T(t,n,a){const d=n=="right"?t.startPoint.x+a:t.startPoint.x-a;if(!e.isTransitionActive){e.isTransitionActive=!0;const o=setInterval(()=>{n=="left"&&t.startPoint.x>d?t.startPoint.x-=2:n=="right"&&t.startPoint.x<d?t.startPoint.x+=2:(e.isTransitionActive=!1,clearInterval(o))},1)}}function M(t,n){let a=S(t,n);for(;Math.abs(a-e.prevValidRandomYposition)<m*3;)a=S(t,n);return e.prevValidRandomYposition=a,a}function L(){for(let t=0;t<3;t++)if(e.opponentCarArray[t].startPoint.y+e.opponentCarArray[t].h>=e.playerCar.startPoint.y&&e.opponentCarArray[t].startPoint.x==e.playerCar.startPoint.x){e.collisionOccurred=!0;break}}function D(){for(let t=0;t<e.opponentCarArray.length;t++)e.opponentCarArray[t].startPoint.y+=O+e.score/5,e.opponentCarArray[t].startPoint.y>f.CANVAS_HEIGHT&&(R(),e.opponentCarArray[t].startPoint.y=M(g.MIN,g.MAX))}function R(){e.score++}function I(){e.score=0,e.gameOver=!1,e.collisionOccurred=!1,e.opponentCarArray=[],e.gameState=s.restart,requestAnimationFrame(h)}function k(){e.gameState==s.running&&(e.gameState=s.paused,cancelAnimationFrame(e.reqAnimFrame),F())}function v(){e.gameState==s.paused&&(e.gameState=s.running,requestAnimationFrame(h))}function G(){e.gameState=s.initialisation,requestAnimationFrame(h)}function W(t,n,a){n.innerHTML=`${a}  &nbsp; &nbsp;<b>${e.score}</b>`,t.appendChild(n)}function $(){e.playerCar=new x(new y(w,f.CANVAS_HEIGHT-m*1.1),m,C,"./assets/images/car1.png");for(let t=0;t<P;t++){const n=new x(new y(w+u*t,S(g.MIN,g.MAX)),m,C,`./assets/images/opponent-car${t+2}.png`);e.opponentCarArray.push(n)}}window.addEventListener("keypress",t=>{switch(t.key){case"a":{e.playerCar.startPoint.x-u>=0&&T(e.playerCar,"left",u);break}case"d":{e.playerCar.startPoint.x+u<=f.CANVAS_WIDTH&&T(e.playerCar,"right",u);break}case"q":{e.gameState==s.running?k():e.gameState==s.paused&&v();break}case"e":{e.gameState==s.gameOver&&I();break}}});const Y=document.querySelector("#enter-btn"),B=document.querySelector("#side-title"),X=document.querySelector("#intro-div"),K=document.querySelector("#right-container"),U=document.querySelector("#leaderboard-ol"),j=document.createElement("li"),z=document.querySelector("#name");let H="";Y.addEventListener("click",()=>{H=z.value||"",X.style.display="none",K.style.display="flex",B.style.display="block",G()});function h(){e.reqAnimFrame=requestAnimationFrame(h),(e.gameState==s.initialisation||e.gameState==s.restart)&&($(),e.gameState=s.running),q(),L(),D(),e.collisionOccurred&&(_(),W(U,j,H),e.highScore=e.score>e.highScore?e.score:e.highScore,e.gameOver=!0,e.gameState=s.gameOver,cancelAnimationFrame(e.reqAnimFrame))}e.gameState!=s.welcomeScreen&&requestAnimationFrame(h);
